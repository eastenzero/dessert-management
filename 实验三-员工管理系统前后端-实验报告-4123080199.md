# 实验三：员工管理系统前后端

## 一、实验目的

- **掌握基于 Spring Boot + MyBatis 的后端 CRUD 开发流程**  
  包括实体类、Mapper、Service、Controller 的编写和分页查询的实现。

- **掌握基于 Vue3 + Element Plus 的前端单页应用开发方法**  
  能够使用表单、表格、分页、弹窗等组件，实现员工信息的新增、编辑、查询和删除。

- **理解前后端分离架构下的接口设计与调用流程**  
  掌握通过 axios 与后端进行 JSON 数据交互的基本模式。

- **综合运用数据库、后端、前端知识构建一个完整的小型管理系统模块**  
  在既有“部门管理”“甜点管理”模块基础上，新增“员工管理”模块。

---

## 二、实验环境

- **操作系统**：Windows 10 / 11
- **JDK 版本**：JDK 17
- **后端技术栈**：
  - Spring Boot 3.0.2
  - MyBatis + MyBatis-Spring-Boot-Starter 3.0.0
  - PageHelper 分页插件 1.4.6
  - Lombok 1.18.x（实验中使用 `@Data` 等注解）
- **前端技术栈**：
  - Vue 3
  - Element Plus
  - axios
- **数据库**：MySQL（数据库名 `desserts`）
- **开发工具**：
  - IDEA / Eclipse（后端）
  - VS Code / WebStorm 等（前端）
  - MySQL 客户端（Navicat / MySQL Workbench / 命令行）

---

## 三、实验内容与要求

在已有“甜点信息管理系统”的基础上，**新增一个“员工管理”模块**，实现以下功能：

1. **员工信息维护**
   - 新增员工信息；
   - 编辑已存在的员工信息；
   - 删除单个或批量删除员工信息。

2. **员工信息查询**
   - 按员工姓名模糊查询；
   - 按所属部门精确查询；
   - 使用分页展示查询结果。

3. **前后端协同**
   - 后端提供 REST 风格接口（`/employee`）；
   - 前端通过 axios 调用接口，使用 Element Plus 组件完成交互界面。

4. **报告撰写**
   - 完成《实验三：员工管理系统前后端》实验报告（本文件），  
     内容包括：实验目的、环境、数据库设计、系统设计、实现步骤、运行结果与总结等。

---

## 四、数据库设计

### 4.1 相关数据表

本实验在 `desserts` 数据库基础上新增一张员工表 `employee`，与已有的 `department` 表关联：

- `department` 表（已有）
  - `id`：部门编号
  - `name`：部门名称
  - `leader`：负责人
  - `phone`：联系电话
  - `descp`：描述

- `employee` 表（新建）
  - `id`：员工编号（主键，自增）
  - `name`：员工姓名（非空）
  - `gender`：性别（如“男”“女”）
  - `dept_id`：所属部门编号，对应 `department.id`
  - `phone`：联系电话
  - `hire_date`：入职日期
  - `salary`：工资
  - `descp`：备注信息

### 4.2 建表 SQL 示例

> 实验中通过 `employee_setup.sql` 创建员工表并插入测试数据。示例结构如下（略去部分细节）：

```sql
USE desserts;

DROP TABLE IF EXISTS employee;
CREATE TABLE employee(
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  gender VARCHAR(10),
  dept_id INT,
  phone VARCHAR(50),
  hire_date DATE,
  salary DOUBLE,
  descp VARCHAR(500)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

## 五、系统设计

### 5.1 功能模块结构

- **员工管理模块**
  - 员工信息新增
  - 员工信息编辑
  - 员工信息删除（单个 / 批量）
  - 员工信息查询（姓名 + 部门，分页）

### 5.2 后端结构设计

- **实体层（domain）**
  - `Employee`：对应 `employee` 表，字段包括 `id,name,gender,deptId,phone,hireDate,salary,descp`。

- **持久层（mapper）**
  - `EmployeeMapper`（接口）
    - `insert(Employee employee)`：新增员工；
    - `list(Employee employee)`：条件查询员工列表；
    - `edit(Employee employee)`：修改员工信息；
    - `delete(Long[] ids)`：根据 ID 列表删除员工。

- **业务层（service）**
  - `EmployeeService`
    - 封装对 `EmployeeMapper` 的调用，提供同名业务方法。

- **控制层（controller）**
  - `EmployeeController`
    - `POST /employee`：新增员工；
    - `GET /employee`：分页条件查询员工列表；
    - `PUT /employee`：修改员工；
    - `DELETE /employee/{ids}`：删除员工（单个或批量）。

- **公共基类**
  - `BaseController`
    - `startPage()`：统一处理分页参数；
    - `getDataByPage(List<?>)`：返回带 `rows` 与 `total` 的分页数据；
    - `toAjax(int rows)`：根据影响行数返回统一的 `AjaxResult`。

### 5.3 前端结构设计

- **API 封装**
  - `src/api/Employee.js`
    - `add(employee)` → `POST /employee`
    - `list(queryParams)` → `GET /employee`
    - `edit(employee)` → `PUT /employee`
    - `del(ids2del)` → `DELETE /employee/{ids}`

- **页面组件**
  - `src/views/Employee.vue`
    - 查询表单：姓名、所属部门；
    - 员工列表：表格展示；
    - 分页组件：切换页码；
    - 弹窗表单：新增 / 编辑员工信息。

- **路由与菜单**
  - `router/index.js` 中新增 `/Employee` 路由；
  - `App.vue` 左侧菜单中新增“员工管理”入口。

---

## 六、实验步骤

### 6.1 数据库准备

1. 在 MySQL 中创建并选择 `desserts` 数据库（若未创建）。
2. 执行已有的 `数据库.SQL`，初始化 `category`、`dessert`、`department` 等表和数据。
3. 执行 `employee_setup.sql`，创建 `employee` 表并插入测试员工数据。

### 6.2 后端实现

#### 6.2.1 创建实体类 Employee

在 `domain` 包下创建 `Employee` 类，使用 Lombok 的 `@Data` 自动生成 getter/setter，并使用 `@DateTimeFormat` 处理日期字段，与前端的日期格式保持一致。

#### 6.2.2 编写 EmployeeMapper

在 `mapper` 包下创建 `EmployeeMapper` 接口，使用 MyBatis 注解编写 SQL：

- `@Insert` 插入员工；
- `@Select` 使用 `<script><where><if>` 标签，实现按姓名模糊、按部门精确查询；
- `@Update` 根据员工 ID 动态更新非空字段；
- `@Delete` 使用 `<foreach>` 实现批量删除。

#### 6.2.3 编写 EmployeeService

在 `service` 包下创建 `EmployeeService`，注入 `EmployeeMapper`，封装增删改查方法，供控制层调用。

#### 6.2.4 编写 EmployeeController

在 `controller` 包下创建 `EmployeeController`，继承 `BaseController`：

- `@PostMapping("/employee")`：接收 `@RequestBody Employee`，调用 `service.add`，返回 `AjaxResult`。
- `@GetMapping("/employee")`：接收查询参数 `Employee`，调用 `startPage()` 开启分页，再通过 `service.list` 返回数据，使用 `getDataByPage()` 封装结果。
- `@PutMapping("/employee")`：接收 `@RequestBody Employee`，调用 `service.edit`。
- `@DeleteMapping("/employee/{ids}")`：接收路径中的 ID 列表，调用 `service.delete`。

启动后端，确认无编译和运行错误。

### 6.3 前端实现

#### 6.3.1 新增 Employee API 模块

在 `src/api` 目录下创建 `Employee.js`，封装对 `/employee` 接口的调用，统一通过自定义 `axios` 实例发送请求。

#### 6.3.2 新增 Employee 页面组件

在 `src/views` 目录下创建 `Employee.vue`，核心逻辑包括：

1. **查询条件表单**
   - 姓名输入框：双向绑定 `queryParams.name`；
   - 部门下拉框：双向绑定 `queryParams.deptId`，通过调用 `DepartmentService.list` 动态加载部门列表；
   - “查询”“重置”按钮：调用 `handleQuery` 和 `resetQuery` 方法。

2. **员工列表展示**
   - 使用 `el-table` 展示员工列表；
   - 表格列包括：姓名、性别、所属部门（通过 `deptId` 映射为部门名）、联系电话、入职日期、工资、备注等；
   - 通过 `@selection-change` 实现多选，用于批量删除。

3. **分页控制**
   - 使用 `el-pagination` 绑定 `queryParams.pageNum` 和 `pageSize`；
   - 在 `@current-change` 事件中重新调用 `getList()` 获取对应页数据。

4. **新增/编辑弹窗**
   - 使用 `el-dialog` + `el-form` 实现员工信息编辑界面；
   - 设置 `rules` 对姓名、部门、电话等进行基本校验；
   - 根据 `employee.id` 是否为空区分新增或编辑，分别调用 `EmployeeService.add` 或 `EmployeeService.edit`。

5. **删除功能**
   - 行内“删除”按钮调用 `handleDelete(row)`；
   - “批量删除”按钮调用 `handleDeleteBatch()`，对选中的 ID 进行批量删除；
   - 使用 `ElMessageBox.confirm` 弹出二次确认对话框。

#### 6.3.3 路由与菜单配置

1. 在 `src/router/index.js` 中引入 `Employee` 组件，并新增路由：

   ```js
   { path: '/Employee', name:'Employee', component:Employee },
   ```

2. 在 `App.vue` 中的侧边栏布局内添加菜单项：

   ```vue
   <router-link to="/Employee" class="nav-link module">员工管理</router-link>
   ```

重启前端项目，在浏览器中访问系统首页，即可通过左侧菜单进入“员工管理”页面。

---

## 七、运行结果

> 以下图片由本人在实际运行系统后自行补充。

- **图 7-1 员工管理主界面**  
  （查询表单 + 员工列表 + 分页）
  
  `![员工管理主界面](images/exp3-employee-main.png)`

- **图 7-2 员工新增/编辑弹窗界面**  
  （姓名、性别、部门、电话、入职日期、工资、备注）

  `![员工新增编辑界面](images/exp3-employee-dialog.png)`

- **图 7-3 按姓名与部门组合条件查询结果截图**

  `![员工查询结果](images/exp3-employee-search.png)`

- **图 7-4 批量删除员工操作截图**

  `![员工批量删除](images/exp3-employee-delete.png)`

---

## 八、实验总结

- **对 Spring Boot + MyBatis 的掌握更加熟练**  
  通过实现员工模块，进一步理解了基于注解的 Mapper 编写和分页查询的实现方式，熟悉了 `BaseController` 封装的一致返回格式。

- **前端组件化开发能力得到提升**  
  在 Vue3 + Element Plus 中复用部门管理的经验，快速实现了表单校验、对话框、分页、表格等功能，体会到了组件化开发带来的高复用性。

- **前后端接口设计意识增强**  
  在本实验中统一使用 REST 风格接口，前端统一通过 `api/Employee.js` 管理请求，前后端分工清晰，接口职责明确。

- **对数据一致性与用户体验有了更多思考**  
  通过部门与员工之间的关联关系设计，体会到数据表之间外键逻辑的重要性；通过错误提示、校验反馈等提升了用户使用体验。

- **不足与改进方向**
  - 当前员工模块只实现了基础信息维护，尚未涉及权限控制、登录用户关联等内容；
  - 数据校验规则较为简单，可以进一步引入后端 Bean 校验（如 `@Valid`）与前端更完善的校验逻辑；
  - 界面样式还可以进一步美化，例如增加搜索条件折叠、表格列宽自适应等。

通过本次实验，我基本完成了一个前后端分离的“员工管理”功能模块开发，为后续构建更复杂的企业级管理系统打下了基础。
